---
layout: page
categories:
- blog
title: High Sierraのインストール問題
---

この問題の原因は，High Sierraのインストーラがタコで，OSInstall.mpkgのセットアップに失敗することにある．
もし，失敗すると，以下のような画面になる．

<img src="https://pbs.twimg.com/media/DKnjshgU8AA1PAf.jpg" width="50%"/>
torotitiさんのTwitterより引用

素直にやれば，再起動し，再度セットアップし，再起動すればいいのだが，FileVaultを使っていると，High Sierraをインストールするためのディスクから起動するしかなくなり，元々の10.12をターゲットとして起動できなくなる．
ゆえに再度セットアップすることができず，High Sierraはセットアップできない，現状の10.12も起動できないというどうしようもない状態になる．

### 大部分のケース

1. mpkgに問題なし
2. FileValutを使っていない

これはすんなりいくケース

### FileVaultのケース

1. mpkgに問題なし
2. FileValutを使っている

これもすんなりいくケース

### ほとんどのケース

1. mpkgに問題あり
2. FileValutを使っていない

再起動すると，ボリュームがロックされていないので，元々の10.12を起動できる．
そこで，再度High sierraのインストーラをセットアップし直し，mpkgの問題が解決するとセットアップがうまくいく．

### 不幸中の幸いのケース

1. mpkgに問題あり
2. FileValutを使っている．

再起動すると，ボリュームがロックされているので，リカバリーモードか，High Sierraのインストールモードでしか起動できない．
つまり，元々の10.12で起動できないので，mpkgを再セットアップできない．
trotitiの場合，リカバリーモードで起動し，ディスクユーティリティでFileVaultをインストールしたボリュームをアンロックしたことで，元々の10.12を起動できたようだ．
10.12が起動できれば，再度High sierraのインストーラをセットアップし直し，mpkgの問題が解決するとセットアップがうまくいく可能性がある．ここでも再度mpkgのセットアップにこけると，上記の手順をやり直すことになる．

### sonsonのケース

1. mpkgに問題あり
2. FileValutを使っている．

再起動すると，ボリュームがロックされているので，リカバリーモードか，High Sierraのインストールモードでしか起動できない．
つまり，元々の10.12で起動できないので，mpkgを再セットアップできない．
sonsonの場合，リカバリーモードで起動し，ディスクユーティリティでFileVaultをインストールしたボリュームをアンロックしても，10.12が起動できなかった．
そこで，diskutilを使い，強制的にFileVaultのlockだけでなく，暗号化も解除した．
暗号化を解除すると，起動ディスクのターゲットに10.12を選択できるようになった．
10.12が起動できれば，再度High sierraのインストーラをセットアップし直し，mpkgの問題が解決するとセットアップがうまくいく可能性がある．ここでも再度mpkgのセットアップにこけると，上記の手順をやり直すことになる．
